<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>æ™ºèƒ½å¾…åŠæ¸…å•</title>
  <meta name="description" content="Vue+Element Pluså¾…åŠæ¸…å•é¡¹ç›®">
  <link rel="stylesheet" href="https://unpkg.com/element-plus@2.4.4/dist/index.css">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
      background-color: #f5f7fa;
    }
    .app-container {
      width: 100%;
      min-height: 100vh;
    }
    .app-header {
      background-color: #1989fa;
      color: white;
      text-align: center;
      padding: 20px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    }
    .app-header h1 {
      margin: 0;
      font-size: 24px;
      font-weight: 600;
    }
    .app-main {
      padding: 20px;
      max-width: 800px;
      margin: 0 auto;
    }
    .todo-card {
      background-color: white;
      border-radius: 8px;
      box-shadow: 0 2px 12px rgba(0, 0, 0, 0.1);
      padding: 20px;
    }
    .card-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
    }
    .card-header span {
      font-size: 18px;
      font-weight: 600;
    }
    .todo-input {
      margin-bottom: 20px;
    }
    .todo-filters {
      margin-bottom: 20px;
      display: flex;
      gap: 10px;
    }
    .todo-list {
      margin: 20px 0;
      border: 1px solid #ebeef5;
      border-radius: 4px;
      overflow: hidden;
    }
    .todo-item {
      padding: 12px 20px;
      border-bottom: 1px solid #ebeef5;
      display: flex;
      justify-content: space-between;
      align-items: center;
      transition: background-color 0.3s;
    }
    .todo-item:last-child {
      border-bottom: none;
    }
    .todo-item:hover {
      background-color: #f5f7fa;
    }
    .todo-content {
      display: flex;
      align-items: center;
      gap: 10px;
      flex: 1;
    }
    .todo-text {
      flex: 1;
    }
    .done {
      text-decoration: line-through;
      color: #999;
    }
    .todo-stats {
      margin-top: 20px;
      padding-top: 15px;
      border-top: 1px solid #ebeef5;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .todo-chart {
      margin-top: 20px;
      padding: 20px;
      background-color: #fafafa;
      border-radius: 8px;
    }
    .todo-chart h3 {
      margin-bottom: 20px;
      font-size: 16px;
      font-weight: 600;
    }
    .chart-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      gap: 20px;
    }
    .chart-item {
      text-align: center;
      padding: 20px;
      background-color: white;
      border-radius: 8px;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }
    .chart-label {
      font-size: 14px;
      color: #666;
      margin-bottom: 10px;
    }
    .chart-value {
      font-size: 28px;
      font-weight: 600;
      color: #333;
    }
    .done-value {
      color: #67c23a;
    }
    .empty-tip {
      text-align: center;
      padding: 40px 20px;
      color: #999;
    }
    .app-footer {
      text-align: center;
      padding: 20px;
      color: #666;
      border-top: 1px solid #e5e5e5;
      margin-top: 20px;
    }
    .fallback-loading {
      width: 100%;
      height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      background-color: #f5f7fa;
    }
    .fallback-card {
      padding: 40px;
      border-radius: 12px;
      background: white;
      box-shadow: 0 2px 12px rgba(0, 0, 0, 0.1);
      text-align: center;
    }
    .fallback-loading-icon {
      font-size: 48px;
      color: #1989fa;
      margin-bottom: 20px;
    }
    .fallback-title {
      font-size: 18px;
      font-weight: 600;
      color: #333;
      margin-bottom: 10px;
    }
    .fallback-desc {
      font-size: 14px;
      color: #666;
      margin-bottom: 20px;
    }
  </style>
</head>
<body>
  <div id="app">
    <div class="app-container">
      <header class="app-header">
        <h1>ğŸ¯ æ™ºèƒ½å¾…åŠæ¸…å•</h1>
      </header>
      <main class="app-main">
        <div class="todo-card">
          <div class="card-header">
            <span>ğŸ“ æˆ‘çš„å¾…åŠæ¸…å•</span>
            <button class="el-button el-button--primary el-button--small" onclick="addTodo()">æ·»åŠ å¾…åŠ</button>
          </div>

          <div class="todo-input">
            <input type="text" id="todoContent" placeholder="è¯·è¾“å…¥å¾…åŠå†…å®¹" class="el-input__inner" style="width: 100%; padding: 8px 15px; border: 1px solid #dcdfe6; border-radius: 4px; font-size: 14px;" onkeyup="if(event.keyCode==13) addTodo()">
          </div>

          <div class="todo-filters">
            <select id="categoryFilter" class="el-select__input" style="padding: 8px 15px; border: 1px solid #dcdfe6; border-radius: 4px; font-size: 14px;">
              <option value="">æ‰€æœ‰åˆ†ç±»</option>
              <option value="å·¥ä½œ">å·¥ä½œ</option>
              <option value="å­¦ä¹ ">å­¦ä¹ </option>
              <option value="ç”Ÿæ´»">ç”Ÿæ´»</option>
              <option value="å…¶ä»–">å…¶ä»–</option>
            </select>
            <select id="priorityFilter" class="el-select__input" style="padding: 8px 15px; border: 1px solid #dcdfe6; border-radius: 4px; font-size: 14px;">
              <option value="">æ‰€æœ‰ä¼˜å…ˆçº§</option>
              <option value="low">ä½</option>
              <option value="medium">ä¸­</option>
              <option value="high">é«˜</option>
            </select>
            <select id="statusFilter" class="el-select__input" style="padding: 8px 15px; border: 1px solid #dcdfe6; border-radius: 4px; font-size: 14px;">
              <option value="">æ‰€æœ‰çŠ¶æ€</option>
              <option value="false">æœªå®Œæˆ</option>
              <option value="true">å·²å®Œæˆ</option>
            </select>
          </div>

          <div class="todo-list" id="todoList">
            <!-- å¾…åŠé¡¹å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
          </div>

          <div class="todo-stats">
            <span id="stats">å·²å®Œæˆï¼š0 / æ€»æ•°ï¼š0</span>
            <button class="el-button el-button--text" onclick="clearDone()" id="clearBtn" disabled>æ¸…ç©ºå·²å®Œæˆ</button>
          </div>

          <div class="todo-chart">
            <h3>ğŸ“Š ä»»åŠ¡ç»Ÿè®¡</h3>
            <div class="chart-grid">
              <div class="chart-item">
                <div class="chart-label">æ€»ä»»åŠ¡æ•°</div>
                <div class="chart-value" id="totalCount">0</div>
              </div>
              <div class="chart-item">
                <div class="chart-label">å·²å®Œæˆ</div>
                <div class="chart-value done-value" id="doneCount">0</div>
              </div>
              <div class="chart-item">
                <div class="chart-label">å®Œæˆç‡</div>
                <div class="chart-value" id="completionRate">0%</div>
              </div>
            </div>
          </div>
        </div>
      </main>
      <footer class="app-footer">
        <p>Â© 2025 æ™ºèƒ½å¾…åŠç³»ç»Ÿ - ç»“è¯¾é¡¹ç›®</p>
      </footer>
    </div>
  </div>

  <script>
    // å…¨å±€å˜é‡
    let todoList = [];
    let nextId = 1;

    // ä»æœ¬åœ°å­˜å‚¨åŠ è½½æ•°æ®
    function loadFromLocalStorage() {
      const stored = localStorage.getItem('todoList');
      if (stored) {
        try {
          todoList = JSON.parse(stored);
          if (todoList.length > 0) {
            nextId = Math.max(...todoList.map(todo => todo.id)) + 1;
          }
        } catch (e) {
          console.error('Failed to parse todo list:', e);
          todoList = [];
        }
      } else {
        // é»˜è®¤æ•°æ®
        todoList = [
          { id: nextId++, content: 'å®ŒæˆVueé¡¹ç›®éƒ¨ç½²', done: false, category: 'å·¥ä½œ', priority: 'high' },
          { id: nextId++, content: 'å­¦ä¹ Element Plus', done: true, category: 'å­¦ä¹ ', priority: 'medium' },
          { id: nextId++, content: 'è´­ä¹°ç”Ÿæ´»ç”¨å“', done: false, category: 'ç”Ÿæ´»', priority: 'low' }
        ];
        saveToLocalStorage();
      }
    }

    // ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨
    function saveToLocalStorage() {
      localStorage.setItem('todoList', JSON.stringify(todoList));
    }

    // è·å–åˆ†ç±»æ ‡ç­¾æ ·å¼
    function getCategoryClass(category) {
      const categoryMap = {
        'å·¥ä½œ': 'el-tag--primary',
        'å­¦ä¹ ': 'el-tag--success',
        'ç”Ÿæ´»': 'el-tag--warning',
        'å…¶ä»–': 'el-tag--info'
      };
      return categoryMap[category] || 'el-tag--info';
    }

    // è·å–ä¼˜å…ˆçº§æ ‡ç­¾æ ·å¼
    function getPriorityClass(priority) {
      const priorityMap = {
        'low': 'el-tag--success',
        'medium': 'el-tag--warning',
        'high': 'el-tag--danger'
      };
      return priorityMap[priority] || 'el-tag--warning';
    }

    // è·å–ä¼˜å…ˆçº§æ–‡æœ¬
    function getPriorityText(priority) {
      const priorityMap = {
        'low': 'ä½',
        'medium': 'ä¸­',
        'high': 'é«˜'
      };
      return priorityMap[priority] || 'ä¸­';
    }

    // æ¸²æŸ“å¾…åŠåˆ—è¡¨
    function renderTodoList() {
      const todoListElement = document.getElementById('todoList');
      const categoryFilter = document.getElementById('categoryFilter').value;
      const priorityFilter = document.getElementById('priorityFilter').value;
      const statusFilter = document.getElementById('statusFilter').value;

      // ç­›é€‰å¾…åŠåˆ—è¡¨
      const filteredTodos = todoList.filter(todo => {
        let match = true;
        if (categoryFilter) {
          match = match && todo.category === categoryFilter;
        }
        if (priorityFilter) {
          match = match && todo.priority === priorityFilter;
        }
        if (statusFilter !== '') {
          match = match && todo.done === (statusFilter === 'true');
        }
        return match;
      });

      if (filteredTodos.length === 0) {
        todoListElement.innerHTML = '<div class="empty-tip">æš‚æ— å¾…åŠï¼Œç‚¹å‡»æ·»åŠ å¼€å§‹å§ï½</div>';
      } else {
        todoListElement.innerHTML = filteredTodos.map(todo => `
          <div class="todo-item">
            <div class="todo-content">
              <input type="checkbox" ${todo.done ? 'checked' : ''} onclick="toggleDone(${todo.id})" style="margin-right: 10px;">
              <span class="todo-text ${todo.done ? 'done' : ''}">${todo.content}</span>
              <span class="el-tag ${getCategoryClass(todo.category)} el-tag--small" style="margin-right: 5px; padding: 2px 8px; border-radius: 4px; font-size: 12px;">${todo.category}</span>
              <span class="el-tag ${getPriorityClass(todo.priority)} el-tag--small" style="margin-right: 5px; padding: 2px 8px; border-radius: 4px; font-size: 12px;">${getPriorityText(todo.priority)}</span>
            </div>
            <button class="el-button el-button--danger el-button--small" onclick="deleteTodo(${todo.id})" style="padding: 4px 12px; font-size: 12px;">åˆ é™¤</button>
          </div>
        `).join('');
      }

      updateStats();
    }

    // æ›´æ–°ç»Ÿè®¡ä¿¡æ¯
    function updateStats() {
      const total = todoList.length;
      const done = todoList.filter(todo => todo.done).length;
      const completionRate = total > 0 ? Math.round((done / total) * 100) : 0;

      document.getElementById('stats').textContent = `å·²å®Œæˆï¼š${done} / æ€»æ•°ï¼š${total}`;
      document.getElementById('totalCount').textContent = total;
      document.getElementById('doneCount').textContent = done;
      document.getElementById('completionRate').textContent = `${completionRate}%`;

      document.getElementById('clearBtn').disabled = done === 0;
    }

    // æ·»åŠ å¾…åŠ
    function addTodo() {
      const input = document.getElementById('todoContent');
      const content = input.value.trim();
      if (!content) return;

      const newTodo = {
        id: nextId++,
        content: content,
        done: false,
        category: 'å·¥ä½œ', // é»˜è®¤åˆ†ç±»
        priority: 'medium' // é»˜è®¤ä¼˜å…ˆçº§
      };

      todoList.unshift(newTodo);
      input.value = '';
      saveToLocalStorage();
      renderTodoList();
    }

    // åˆ‡æ¢å®ŒæˆçŠ¶æ€
    function toggleDone(id) {
      const todo = todoList.find(t => t.id === id);
      if (todo) {
        todo.done = !todo.done;
        saveToLocalStorage();
        renderTodoList();
      }
    }

    // åˆ é™¤å¾…åŠ
    function deleteTodo(id) {
      todoList = todoList.filter(todo => todo.id !== id);
      saveToLocalStorage();
      renderTodoList();
    }

    // æ¸…ç©ºå·²å®Œæˆ
    function clearDone() {
      todoList = todoList.filter(todo => !todo.done);
      saveToLocalStorage();
      renderTodoList();
    }

    // ç­›é€‰äº‹ä»¶ç›‘å¬
    document.getElementById('categoryFilter').addEventListener('change', renderTodoList);
    document.getElementById('priorityFilter').addEventListener('change', renderTodoList);
    document.getElementById('statusFilter').addEventListener('change', renderTodoList);

    // åˆå§‹åŒ–
    loadFromLocalStorage();
    renderTodoList();
  </script>
</body>
</html>